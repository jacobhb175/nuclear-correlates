---
title: "Index"
author: "Jacob Hardin-Bernhardt"
format: html
execute: 
  echo: FALSE
---

```{r}
#| label: setup
#| message: false
library(tidyverse)
library(dplyr)
library(primer.data)
library(brms)
library(tidybayes)
library(gtsummary)
library(ggthemes)
library(tibble)
#library(plotly)
```

```{r}
#| label: data

DYMID<-read.csv("dyadic_mid_4.02.csv")


DYMID$year <- as.integer(DYMID$year)
DYMID$strtyr <- as.integer(DYMID$strtyr)
DYMID_N <- DYMID %>% mutate(modern=case_when((strtyr<1945)~0,(strtyr>=1945)~1))
DYMID_N <- DYMID_N %>% mutate(nucleara = case_when(
  (strtyr<1945) ~ 0,
  (
    ((namea=="USA") & (strtyr >= 1945)) |
    ((namea=="RUS") & (strtyr >= 1949)) |
    ((namea=="UKG") & (strtyr >= 1952)) |
    ((namea=="FRN") & (strtyr >= 1960)) |
    ((namea=="CHN") & (strtyr >= 1964)) |
    ((namea=="ISR") & (strtyr >= 1966)) |
    ((namea=="IND") & (strtyr >= 1974)) |
    ((namea=="PAK") & (strtyr >= 1998)) |
    ((namea=="PRK") & (strtyr >= 2006)) 
    ) ~ 1,
  stateb > 450 ~ 0),
  nuclearb = case_when(
  (strtyr<1945) ~ 0,
  (
    ((nameb=="USA") & (strtyr >= 1945)) |
    ((nameb=="RUS") & (strtyr >= 1949)) |
    ((nameb=="UKG") & (strtyr >= 1952)) |
    ((nameb=="FRN") & (strtyr >= 1960)) |
    ((nameb=="CHN") & (strtyr >= 1964)) |
    ((nameb=="ISR") & (strtyr >= 1966)) |
    ((nameb=="IND") & (strtyr >= 1974)) |
    ((nameb=="PAK") & (strtyr >= 1998)) |
    ((nameb=="PRK") & (strtyr >= 2006))
    ) ~ 1,
  strtyr  >= 1945 ~ 0) 
  ) %>%
  select(nucleara,nuclearb,strtyr,namea,nameb,everything()) %>%
  arrange(desc(nucleara))

DYMID_N <- DYMID_N %>% mutate(greata = case_when(
    ((namea=="AUH") & (strtyr <= 1918)) |
    ((namea=="CHN") & (strtyr >= 1896)) |
    ((namea=="UKG") & (strtyr >= 1952)) |
    (namea=="FRN") |
    (namea=="GMY") |
    (namea=="ITA") |
    (namea=="RUS") |
    (namea=="UKG") |
    (namea=="USA") ~ TRUE,
    TRUE ~ FALSE
  ),
  greatb = case_when(
    ((nameb=="AUH") & (strtyr <= 1918)) |
    ((nameb=="CHN") & (strtyr >= 1896)) |
    ((nameb=="UKG") & (strtyr >= 1952)) |
    (nameb=="FRN") |
    (nameb=="GMY") |
    (nameb=="ITA") |
    (nameb=="RUS") |
    (nameb=="UKG") |
    (nameb=="USA") ~ TRUE,
    TRUE ~ FALSE
  ),
)

DYMID_N <- DYMID_N |> drop_na() %>% mutate(nuclear=nucleara+nuclearb) %>%
  select(nuclear,everything()) %>%
  arrange(desc(nuclear))

DYMID_N <- DYMID_N |> drop_na() %>% mutate(great=greata+greatb) %>%
  select(great,everything()) %>%
  arrange(desc(great))


DYMID_N <- DYMID_N |> mutate(modern=case_when(
  (strtyr<=1945)~FALSE,
  (strtyr>1945)~TRUE,
  TRUE ~ NA))

DYMID_N <- DYMID_N |>
mutate(escalated=case_when(
  (hihost<=3)~FALSE,
  (hihost>3)~TRUE,
  TRUE ~ NA))

DYMID_N <- (DYMID_N |> drop_na())
DYMID_N <- DYMID_N |> select(great, nuclear,strtyr,modern,outcome,hihost,escalated,settlmnt,fatlev,highact,cumdurat)

DYMID_N <- DYMID_N |> mutate(great=as.factor(great))
DYMID_N <- DYMID_N |> mutate(nuclear=as.factor(nuclear))

set.seed(9)

nuclear_data <- DYMID_N  |> 
  drop_na() 

```


```{r}
#| label: model
#| cache: true

fit_nuclear<-brm(formula = escalated ~ modern+great+nuclear, data = nuclear_data, family = bernoulli(), refresh = 0, silent = 2, seed = 19)
```

```{r}
#| label: plot
#| message: false

#posterior_interval(fit_nuclear)
#fixef(fit_nuclear)
#pp_check(fit_nuclear)

#fit_nuclear |>
#tbl_regression()

ndata <- tibble(expand_grid(modern = c(TRUE,FALSE), great = c(0, 1, 2), nuclear = c(0, 1, 2)))


combined_data <- fit_nuclear |>
  add_epred_draws(newdata = ndata) |>
  pivot_longer(cols = c(great, nuclear), names_to = "category", values_to = "value")

full_plot <- ggplot(combined_data,aes(x = .epred, y = category, fill = as.factor(value))) +
  stat_slab(alpha=0.8) +
  scale_fill_calc() +
  scale_x_continuous(labels=scales::percent_format()) +
  scale_y_discrete(labels=c("Great","Nuclear")) +
  labs(y="Category",x="Predicted Chance of High Escalation",fill="Involved Powers",title="Effects of Nuclear Proliferation on Peace",caption="Correlates of War Project",subtitle="The difference between nuclear and great power proliferation is negligible")

full_plot
```

The chance of major escalation in a conflict varies depending on the involvement of great or nuclear powers. Using data from all militarized disputes between two states in the world between 1816 and 2014, we seek to measure the deterrent effect of nuclear powers as opposed to great powers. We modeled escalated, a binary TRUE/FALSE variable measuring whether a conflict escalated to involve the use of force by one or more state against another, as a linear function of great power involvement, nuclear power involvement, and whether or not the conflict takes place in the modern era. Conflicts involving more great powers, conflicts involving more nuclear powers, and conflicts in the modern era were all less likely to be escalated. The effects of nuclear proliferation as opposed to those of great power involvement on peace are negligible.

